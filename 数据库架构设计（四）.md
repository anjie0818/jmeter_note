# 数据库架构设计

标签： 数据库，MySQL

----

**Contents**

- [数据库架构设计](#数据库架构设计)
    - [数据库架构设计初步认识](#数据库架构设计初步认识)
    - [分库分表](#分库分表)

----



## 数据库架构设计初步认识

	1.测试范围
		* SQL语句 慢查询 插入等
		* 资源使用率
		* 数据库架构合理性
		* 数据库性能指标
	
	2.常用架构
		* 一主多从（一台Master负责写入操作，多台Slave负责读操作，Master定点向Slave复制数据）
		* 双机热备（读写都在一台服务器上，没有一主多从的延时，Master挂了，KeepAlived会将虚拟IP指向Slave备用机，高可用）

	3.原理
		* 主从同步
			1.Master将改变记录到二进制日志中
			2.slave将master的二进制日志文件拷贝到它的中继日志（relay log）中
			3.slave重做中继日志的事件，将改变反映到他自己的数据里
			4.跨服务器的会受到网络，硬件I/O等影响，延迟无可避免



## 分库分表
	
	1.拆分原因
		* 单表或者数据量太大
		* 硬件不能升级
		
	2.方案
		* 业务拆分：用户，订单，商品拆分
		* 垂直拆分：商品表过大，将不同分类的商品拆分，订单表过大，将旧订单数据拆分
		* 水平拆分：一致性hash算法，统一一种算法，如hashmap的，对用户id进行hash并取模，得到的数进行分表